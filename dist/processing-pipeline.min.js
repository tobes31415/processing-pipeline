!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var o=r();for(var t in o)("object"==typeof exports?exports:e)[t]=o[t]}}(this,function(){return function(e){function r(t){if(o[t])return o[t].exports;var n=o[t]={exports:{},id:t,loaded:!1};return e[t].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}var o={};return r.m=e,r.c=o,r.p="",r(r.s=8)}([function(e,r,o){function t(){"use strict";return new n.a}var n=o(7),i=o(6);r.create=t,i.a.PipelineFactory={create:t}},function(e,r,o){function t(){"use strict";function e(){i={}}function r(e){if(!e)throw new Error("CacheContext cannot be null");if("object"!=typeof e&&"function"!=typeof e)throw new Error("CacheContext must be an object or function");var r=e[n];return r||(r=""+Math.floor(99999*Math.random()),e[n]=r),r}function o(){var e=Array.prototype.slice.call(arguments,0),o=e.reduce(function(e,o){return(""|e)+r(o)+"|"}),t=i[o];return t||(t={},i[o]=t),t}var t=this,i={};t.clear=e,t.get=o}r.a=t;const n=Symbol("cacheManagerContext")},function(e,r,o){function t(e,r){return e.reduce(function(e,o){var t=r.changed[o]||!1;return t||(t=i(o,r).detectChanges(o,r),t&&(r.changed[o]=!0)),e||t},null)}function n(e){var r={};for(var o in e.model)r[o]=!0;for(o in e.changed)r[o]=!0;for(o in r)o.indexOf(a)===-1&&i(o,e).updateHistory(o,e)}function i(e,r){var o=r.model[e+a]||d;if("object"==typeof o){if("function"==typeof o.detectChanges&&"function"==typeof o.updateHistory)return o;throw new Error("When specifiying a custom mode you must supply a detectChanges function, and an updateHistory function")}if("string"!=typeof o)throw new Error("Only String and Object are allowed values for ChangeMode");if(o=o.toLowerCase(),o===f)return s;if(o===u)return c;throw new Error("Change detection mode not recognized")}var s=o(4),c=o(3);r.detectChanges=t,r.updateHistory=n;const a="_ChangeMode",f="json",u="identity",d=f},function(e,r,o){function t(e,r){var o=r.model[e],t=r.history[e];if(void 0===t!=(void 0===o))return!0;if(void 0===o)return!1;if("object"==typeof o){var n={},i=[];for(var s in o)i.push(s);for(var c in t)i.push(c);for(var a=0;a<i.length;a++){var f=i[a];if(!n[f]&&(n[f]=!0,o[f]!==t[f]))return!0}return!1}return t!==o}function n(e,r){var o=r.model[e];if(void 0===o)delete r.history[e];else if("object"==typeof o){r.history[e]={};for(var t in o)r.history[e][t]=o[t]}else r.history[e]=r.model[e]}r.detectChanges=t,r.updateHistory=n},function(e,r,o){function t(e,r){return void 0===r.history[e]!=(void 0===r.model[e])||void 0!==r.model[e]&&JSON.stringify(r.model[e])!==r.history[e]}function n(e,r){"undefined"===r.model[e]?delete r.history[e]:r.history[e]=JSON.stringify(r.model[e])}r.detectChanges=t,r.updateHistory=n},function(e,r,o){function t(){var e={};return e.promise=new Promise(function(r,o){e.resolve=r,e.reject=o}),e}r.a=t},function(e,r,o){(function(e){function o(){var r;if(function(){r=this}(),!r){try{r=window}catch(o){}try{r=e}catch(o){}}return r||{}}r.a=o()}).call(r,function(){return this}())},function(e,r,o){function t(){"use strict";function e(e,r){if(b)return m.suppressConsole||console.error("Can't accept new process request because the pipeline is halted"),Promise.reject("pipeline is halted");var o=s.a();return g.push({deferred:o,model:e,processor:r||f}),t(),o.promise}function r(){b=!0}function o(){b=!1,g=[],g.push({model:{},processor:C.clear}),t()}function t(){if(!b&&!j&&g.length>0){j=!0;var e=g.shift(),r={model:e.model,history:x,changed:{}},o=function(){if(j=!1,i.updateHistory(r),m.debug){var e={},o={};for(var n in r.performance){var s=r.performance[n];s>=2?o[n]=s:e[n]=s}console.log(o,e)}setTimeout(t,0)},n=d(r,e.processor);n["catch"](u(e.deferred.reject)),n.then(o,o),n.then(e.deferred.resolve,e.deferred.resolve)}}function u(e){return function(r){w===c?(m.halt(),m.suppressConsole||console.error(r),e(r)):w===a?m.suppressConsole||console.warn(r):console.error("Wait... what?")}}function d(e,r){if(!r)throw new Error("Processor undefined");if(b)return Promise.resolve();var o;if("function"==typeof r?o=l:"string"==typeof r?o=p:Array.isArray(r)?o=y:"object"==typeof r&&(o=h),!o)throw new Error("Not sure how to run processor",r);try{return o(e,r)}catch(t){return Promise.reject(t)}}function l(e,r){return Promise.resolve(r({model:e.model,changed:e.changed,cache:C.get(m,r)}))}function p(e,r){var o,t=r.toLowerCase();if(e.model&&e.model.processors&&(o=e.model.processors[t]),o||(o=m.processors[t]),!o)throw new Error("Couldn't find processor "+t);var n=performance.now(),i=d(e,o);return i.then(function(){var r=performance.now();e.performance=e.performance||{},e.performance[t]=Math.floor(1e4*(r-n))/1e4}),i}function h(e,r){if(!r.runs||"string"!=typeof r.runs&&"object"!=typeof r.runs&&"function"!=typeof r.runs)throw new Error("Object based processor must have a 'runs' property containing a processor defintion");var o=!0;return"string"==typeof r.watches&&(r.watches=[r.watches]),Array.isArray(r.watches)&&(o=i.detectChanges(r.watches,e)),r[E]||(o=!0,r[E]=!0),o?d(e,r.runs):Promise.resolve()}function y(e,r){return new Promise(function(o,t){function n(){if(0===i.length)o();else{var r=d(e,i.shift());r["catch"](u(t)),r.then(n,n)}}var i=r.slice();n()})}function v(e){if(e!==c&&e!==a)throw new Error("On fail only accepts a single string value which must be exactly 'halt' or 'warn'");w=e}var m=this,w=a,g=[],C=new n.a,b=!1,j=!1,x={},E=Symbol("didRunOnce");m.processors={},m.process=e,m.halt=r,m.restart=o,m.onFail=v,m.suppressConsole=!1,m.debug=!1}var n=o(1),i=o(2),s=o(5);r.a=t;const c="halt",a="warn",f="start"},function(e,r,o){e.exports=o(0)}])});
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var o in r)("object"==typeof exports?exports:e)[o]=r[o]}}(this,function(){return function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={exports:{},id:o,loaded:!1};return e[o].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(t.s=7)}([function(e,t,r){function o(){"use strict";return new n.a}var n=r(6);t.create=o},function(e,t,r){function o(){"use strict";function e(){i={}}function t(e){if(!e)throw new Error("CacheContext cannot be null");if("object"!=typeof e&&"function"!=typeof e)throw new Error("CacheContext must be an object or function");var t=e[n];return t||(t=""+Math.floor(99999*Math.random()),e[n]=t),t}function r(){var e=Array.prototype.slice.call(arguments,0),r=e.reduce(function(e,r){return(""|e)+t(r)+"|"}),o=i[r];return o||(o={},i[r]=o),o}var o=this,i={};o.clear=e,o.get=r}t.a=o;const n=Symbol("cacheManagerContext")},function(e,t,r){function o(e,t){return e.reduce(function(e,r){var o=t.changed[r]||!1;return o||(o=i(r,t).detectChanges(r,t),o&&(t.changed[r]=!0)),e||o},null)}function n(e){for(var t in e.changed)i(t,e).updateHistory(t,e)}function i(e,t){var r=t.model[e+u]||d;if("object"==typeof r){if("function"==typeof r.detectChanges&&"function"==typeof r.updateHistory)return r;throw new Error("When specifiying a custom mode you must supply a detectChanges function, and an updateHistory function")}if("string"!=typeof r)throw new Error("Only String and Object are allowed values for ChangeMode");if(r=r.toLowerCase(),r===a)return s;if(r===f)return c;throw new Error("Change detection mode not recognized")}var s=r(4),c=r(3);t.detectChanges=o,t.updateHistory=n;const u="_ChangeMode",a="json",f="identity",d=a},function(e,t,r){function o(e,t){var r=t.model[e],o=t.history[e];if(void 0===o!=(void 0===r))return!0;if(void 0===r)return!1;if("object"==typeof r){var n={},i=[];for(var s in r)i.push(s);for(var c in o)i.push(c);for(var u=0;u<i.length;u++){var a=i[u];if(!n[a]&&(n[a]=!0,r[a]!==o[a]))return!0}return!1}return o!==r}function n(e,t){var r=t.model[e];if(void 0===r)delete t.history[e];else if("object"==typeof r){t.history[e]=t.history[e]||{};for(var o in r)t.history[e][o]=r[o]}else t.history[e]=t.model[e]}t.detectChanges=o,t.updateHistory=n},function(e,t,r){function o(e,t){return void 0===t.history[e]!=(void 0===t.model[e])||void 0!==t.model[e]&&JSON.stringify(t.model[e])!==t.history[e]}function n(e,t){"undefined"===t.model[e]?delete t.history[e]:t.history[e]=JSON.stringify(t.model[e])}t.detectChanges=o,t.updateHistory=n},function(e,t,r){function o(){var e=this||{};return e.promise=new Promise(function(t,r){e.resolve=t,e.reject=r}),e}t.a=o},function(e,t,r){function o(){"use strict";function e(e,t){var r=s.a();return g.push({deferred:r,model:e,processor:t||u}),o(),r.promise}function t(){b=!0}function r(){b=!1,g=[],g.push({model:{},processor:w.clear}),o()}function o(){if(!b&&!C&&g.length>0){var e=g.shift(),t={model:e.model,history:j,changed:{}},r=function(){C=!1,i.updateHistory(t),e.deferred.resolve(),setTimeout(o,0)},n=f(t,e.processor);n["catch"](a),n.then(r,r)}}function a(e){m===c?(v.halt(),console.error(e)):console.warn(e)}function f(e,t){if(!t)throw new Error("Processor undefined");if(b)return Promise.resolve();var r;if("function"==typeof t?r=d:"string"==typeof t?r=h:Array.isArray(t)?r=p:"object"==typeof t&&(r=l),r)return r(e,t);throw new Error("Not sure how to run processor",t)}function d(e,t){return Promise.resolve(t({model:e.model,changed:e.changed,cache:w.get(v,t)}))}function h(e,t){return f(e,e.model.processors[t.toLowerCase()])}function l(e,t){if(!t.runs||"string"!=typeof t.runs&&"object"!=typeof t.runs&&"function"!=typeof t.runs)throw new Error("Object based processor must have a 'runs' property containing a processor defintion");var r=!0;return"string"==typeof t.watches&&(t.watches=[t.watches]),Array.isArray(t.watches)&&(r=i.detectChanges(t.watches,e)),r?f(e,t.runs):Promise.resolve()}function p(e,t){return new Promise(function(r,o){function n(){if(0===i.length)r();else{var t=f(e,i.shift());t["catch"](a),t.then(n,n)}}var i=t.slice();n()})}function y(e){if("halt"!==e&&"warn"!==e)throw new Error("On fail only accepts a single string value which must be exactly 'HALT' or 'WARN'");m=e}var v=this,m=c,g=[],w=new n.a,b=!1,C=!1,j={};v.process=e,v.halt=t,v.restart=r,v.onFail=y}var n=r(1),i=r(2),s=r(5);t.a=o;const c="HALT",u="start"},function(e,t,r){e.exports=r(0)}])});